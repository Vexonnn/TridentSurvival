-- Modified Midnight Galaxy Theme GUI
print("Script starting...")

local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "MidnightGUI"
ScreenGui.Parent = game.CoreGui
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
ScreenGui.ResetOnSpawn = false

print("ScreenGui created")

-- Services
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local Workspace = game:GetService("Workspace")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Lighting = game:GetService("Lighting")
local LocalPlayer = Players.LocalPlayer

-- ============================================
-- INSERT THIS RIGHT AFTER LINE 17 (after local LocalPlayer = Players.LocalPlayer)
-- THEN DELETE LINES 152-217 (the old loading animation at the bottom)
-- ============================================

local TweenService = game:GetService("TweenService")
local CORRECT_KEY = "FREEALWAYS"
local DISCORD_LINK = "https://discord.gg/k5NnrQdYNV"
local KeySystemPassed = false

-- Helper functions for key system
local function addCorner(parent, radius)
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, radius or 15)
    corner.Parent = parent
    return corner
end

local function addStroke(parent, color, thickness, transparency)
    local stroke = Instance.new("UIStroke")
    stroke.Color = color
    stroke.Thickness = thickness or 2
    stroke.Transparency = transparency or 0.5
    stroke.Parent = parent
    return stroke
end

-- Create Key System Frame
local KeySystemFrame = Instance.new("Frame")
KeySystemFrame.Name = "KeySystemFrame"
KeySystemFrame.Parent = ScreenGui
KeySystemFrame.BackgroundColor3 = Color3.fromRGB(15, 10, 30)
KeySystemFrame.BorderSizePixel = 0
KeySystemFrame.Position = UDim2.new(0.5, -200, 0.5, -175)
KeySystemFrame.Size = UDim2.new(0, 400, 0, 350)
KeySystemFrame.Active = true
KeySystemFrame.Draggable = true
KeySystemFrame.ZIndex = 1000

-- Apply gradient and effects to frame
local KeyGradient = Instance.new("UIGradient")
KeyGradient.Color = ColorSequence.new{
    ColorSequenceKeypoint.new(0, Color3.fromRGB(25, 15, 50)),
    ColorSequenceKeypoint.new(0.5, Color3.fromRGB(50, 20, 80)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(30, 10, 60))
}
KeyGradient.Rotation = 45
KeyGradient.Parent = KeySystemFrame

addCorner(KeySystemFrame, 15)
addStroke(KeySystemFrame, Color3.fromRGB(100, 60, 150), 3, 0.3)

-- Animate gradient
task.spawn(function()
    while KeySystemFrame.Parent do
        KeyGradient.Rotation = KeyGradient.Rotation + 0.5
        task.wait(0.05)
    end
end)

-- Add floating particles
for i = 1, 20 do
    local particle = Instance.new("Frame")
    particle.Parent = KeySystemFrame
    particle.BackgroundColor3 = Color3.fromRGB(200, 150, 255)
    particle.BorderSizePixel = 0
    particle.Size = UDim2.new(0, math.random(2, 5), 0, math.random(2, 5))
    particle.Position = UDim2.new(math.random(), 0, math.random(), 0)
    particle.BackgroundTransparency = math.random(30, 70) / 100
    particle.ZIndex = 1000
    addCorner(particle, 100)
    
    task.spawn(function()
        while particle.Parent do
            local pos = particle.Position
            particle.Position = UDim2.new(pos.X.Scale + 0.002, 0, pos.Y.Scale - 0.001, 0)
            if particle.Position.X.Scale > 1.1 or particle.Position.Y.Scale < -0.1 then
                particle.Position = UDim2.new(-0.1, 0, math.random(), 0)
            end
            task.wait(0.03)
        end
    end)
end

-- Logo
local KeyLogo = Instance.new("ImageLabel")
KeyLogo.Parent = KeySystemFrame
KeyLogo.BackgroundTransparency = 1
KeyLogo.Position = UDim2.new(0.5, -40, 0, 30)
KeyLogo.Size = UDim2.new(0, 80, 0, 80)
KeyLogo.Image = "rbxassetid://4483345998"
KeyLogo.ImageColor3 = Color3.fromRGB(180, 120, 230)
KeyLogo.ZIndex = 1001

-- Title
local KeyTitle = Instance.new("TextLabel")
KeyTitle.Parent = KeySystemFrame
KeyTitle.BackgroundTransparency = 1
KeyTitle.Position = UDim2.new(0, 0, 0, 120)
KeyTitle.Size = UDim2.new(1, 0, 0, 40)
KeyTitle.Font = Enum.Font.GothamBold
KeyTitle.Text = "MIDNIGHT HUB"
KeyTitle.TextColor3 = Color3.fromRGB(220, 180, 255)
KeyTitle.TextSize = 28
KeyTitle.ZIndex = 1001
addStroke(KeyTitle, Color3.fromRGB(80, 40, 120), 2)

-- Subtitle
local KeySubtitle = Instance.new("TextLabel")
KeySubtitle.Parent = KeySystemFrame
KeySubtitle.BackgroundTransparency = 1
KeySubtitle.Position = UDim2.new(0, 0, 0, 160)
KeySubtitle.Size = UDim2.new(1, 0, 0, 20)
KeySubtitle.Font = Enum.Font.Gotham
KeySubtitle.Text = "Enter Key to Continue"
KeySubtitle.TextColor3 = Color3.fromRGB(180, 140, 220)
KeySubtitle.TextSize = 14
KeySubtitle.ZIndex = 1001

-- Key Input Box
local KeyInputBox = Instance.new("TextBox")
KeyInputBox.Parent = KeySystemFrame
KeyInputBox.BackgroundColor3 = Color3.fromRGB(30, 20, 50)
KeyInputBox.BorderSizePixel = 0
KeyInputBox.Position = UDim2.new(0.5, -150, 0, 200)
KeyInputBox.Size = UDim2.new(0, 300, 0, 40)
KeyInputBox.Font = Enum.Font.GothamBold
KeyInputBox.PlaceholderText = "Enter Key..."
KeyInputBox.PlaceholderColor3 = Color3.fromRGB(100, 70, 140)
KeyInputBox.Text = ""
KeyInputBox.TextColor3 = Color3.fromRGB(220, 180, 255)
KeyInputBox.TextSize = 16
KeyInputBox.TextXAlignment = Enum.TextXAlignment.Center
KeyInputBox.ZIndex = 1001
KeyInputBox.ClearTextOnFocus = false
addCorner(KeyInputBox, 8)
local KeyInputStroke = addStroke(KeyInputBox, Color3.fromRGB(100, 60, 150), 2, 0.5)

-- Submit Button
local SubmitButton = Instance.new("TextButton")
SubmitButton.Parent = KeySystemFrame
SubmitButton.BackgroundColor3 = Color3.fromRGB(80, 50, 130)
SubmitButton.BorderSizePixel = 0
SubmitButton.Position = UDim2.new(0.5, -100, 0, 255)
SubmitButton.Size = UDim2.new(0, 200, 0, 35)
SubmitButton.Font = Enum.Font.GothamBold
SubmitButton.Text = "SUBMIT KEY"
SubmitButton.TextColor3 = Color3.fromRGB(255, 255, 255)
SubmitButton.TextSize = 16
SubmitButton.ZIndex = 1001
SubmitButton.AutoButtonColor = false
addCorner(SubmitButton, 8)
addStroke(SubmitButton, Color3.fromRGB(120, 80, 180), 2)

-- Discord Button
local DiscordButton = Instance.new("TextButton")
DiscordButton.Parent = KeySystemFrame
DiscordButton.BackgroundColor3 = Color3.fromRGB(60, 40, 100)
DiscordButton.BorderSizePixel = 0
DiscordButton.Position = UDim2.new(0.5, -100, 0, 300)
DiscordButton.Size = UDim2.new(0, 200, 0, 30)
DiscordButton.Font = Enum.Font.GothamBold
DiscordButton.Text = "ðŸ“‹ Copy Discord Link"
DiscordButton.TextColor3 = Color3.fromRGB(200, 160, 240)
DiscordButton.TextSize = 14
DiscordButton.ZIndex = 1001
DiscordButton.AutoButtonColor = false
addCorner(DiscordButton, 8)
addStroke(DiscordButton, Color3.fromRGB(100, 60, 150), 2, 0.5)

-- Status Message
local StatusMessage = Instance.new("TextLabel")
StatusMessage.Parent = KeySystemFrame
StatusMessage.BackgroundTransparency = 1
StatusMessage.Position = UDim2.new(0, 0, 0, 175)
StatusMessage.Size = UDim2.new(1, 0, 0, 20)
StatusMessage.Font = Enum.Font.GothamBold
StatusMessage.Text = ""
StatusMessage.TextColor3 = Color3.fromRGB(255, 100, 100)
StatusMessage.TextSize = 14
StatusMessage.ZIndex = 1001
StatusMessage.Visible = false
local StatusStroke = addStroke(StatusMessage, Color3.fromRGB(200, 50, 50), 1)

-- Shake function for wrong key
local function shakeFrame()
    local originalPos = KeySystemFrame.Position
    for _, offset in ipairs({10, -10, 10, -10, 0}) do
        TweenService:Create(KeySystemFrame, TweenInfo.new(0.05), {
            Position = originalPos + UDim2.new(0, offset, 0, 0)
        }):Play()
        task.wait(0.05)
    end
    KeySystemFrame.Position = originalPos
end

-- Unlock function
local function unlockGUI()
    StatusMessage.Text = "âœ“ KEY CORRECT! Loading..."
    StatusMessage.TextColor3 = Color3.fromRGB(100, 255, 100)
    StatusStroke.Color = Color3.fromRGB(50, 200, 50)
    StatusMessage.Visible = true
    SubmitButton.BackgroundColor3 = Color3.fromRGB(50, 150, 50)
    task.wait(1)
    
    -- Fade out animation
    for _, obj in pairs(KeySystemFrame:GetDescendants()) do
        if obj:IsA("TextLabel") or obj:IsA("TextBox") or obj:IsA("TextButton") then
            TweenService:Create(obj, TweenInfo.new(0.5), {TextTransparency = 1}):Play()
        elseif obj:IsA("ImageLabel") then
            TweenService:Create(obj, TweenInfo.new(0.5), {ImageTransparency = 1}):Play()
        elseif obj:IsA("UIStroke") then
            TweenService:Create(obj, TweenInfo.new(0.5), {Transparency = 1}):Play()
        elseif obj:IsA("Frame") and obj ~= KeySystemFrame then
            TweenService:Create(obj, TweenInfo.new(0.5), {BackgroundTransparency = 1}):Play()
        end
    end
    TweenService:Create(KeySystemFrame, TweenInfo.new(0.5), {BackgroundTransparency = 1}):Play()
    
    task.wait(0.5)
    KeySystemFrame:Destroy()
    
    -- Set flag to continue loading
    KeySystemPassed = true
end

-- Submit Button Click
SubmitButton.MouseButton1Click:Connect(function()
    if KeyInputBox.Text == CORRECT_KEY then
        unlockGUI()
    else
        StatusMessage.Text = "âœ— INCORRECT KEY!"
        StatusMessage.TextColor3 = Color3.fromRGB(255, 100, 100)
        StatusStroke.Color = Color3.fromRGB(200, 50, 50)
        StatusMessage.Visible = true
        SubmitButton.BackgroundColor3 = Color3.fromRGB(150, 50, 50)
        KeyInputStroke.Color = Color3.fromRGB(200, 50, 50)
        KeyInputStroke.Transparency = 0
        shakeFrame()
        task.wait(1.5)
        StatusMessage.Visible = false
        SubmitButton.BackgroundColor3 = Color3.fromRGB(80, 50, 130)
        KeyInputStroke.Color = Color3.fromRGB(100, 60, 150)
        KeyInputStroke.Transparency = 0.5
    end
end)

-- Discord Button Click
DiscordButton.MouseButton1Click:Connect(function()
    setclipboard(DISCORD_LINK)
    local originalText = DiscordButton.Text
    DiscordButton.Text = "âœ“ Link Copied!"
    DiscordButton.BackgroundColor3 = Color3.fromRGB(80, 120, 80)
    task.wait(2)
    DiscordButton.Text = originalText
    DiscordButton.BackgroundColor3 = Color3.fromRGB(60, 40, 100)
end)

-- Enter key to submit
KeyInputBox.FocusLost:Connect(function(enterPressed)
    if enterPressed then
        SubmitButton.MouseButton1Click:Fire()
    end
end)

-- Button hover effects
SubmitButton.MouseEnter:Connect(function()
    TweenService:Create(SubmitButton, TweenInfo.new(0.2), {
        BackgroundColor3 = Color3.fromRGB(100, 70, 150)
    }):Play()
end)

SubmitButton.MouseLeave:Connect(function()
    TweenService:Create(SubmitButton, TweenInfo.new(0.2), {
        BackgroundColor3 = Color3.fromRGB(80, 50, 130)
    }):Play()
end)

DiscordButton.MouseEnter:Connect(function()
    TweenService:Create(DiscordButton, TweenInfo.new(0.2), {
        BackgroundColor3 = Color3.fromRGB(80, 60, 120)
    }):Play()
end)

DiscordButton.MouseLeave:Connect(function()
    TweenService:Create(DiscordButton, TweenInfo.new(0.2), {
        BackgroundColor3 = Color3.fromRGB(60, 40, 100)
    }):Play()
end)

-- ============================================
-- WAIT FOR KEY SYSTEM TO PASS BEFORE LOADING REST
-- ============================================
print("Waiting for key system...")
repeat task.wait() until KeySystemPassed
print("Key system passed! Loading main GUI...")

-- ============================================
-- END OF KEY SYSTEM - REST OF SCRIPT CONTINUES BELOW
-- ============================================

local MainFrame = Instance.new("Frame")
local TopBar = Instance.new("Frame")
local Title = Instance.new("TextLabel")
local Logo = Instance.new("ImageLabel")
local UICorner = Instance.new("UICorner")
local UICorner2 = Instance.new("UICorner")

-- Tab Buttons
local TabButtonsFrame = Instance.new("Frame")
local Tab1Button = Instance.new("TextButton")
local Tab2Button = Instance.new("TextButton")
local Tab3Button = Instance.new("TextButton")

-- Tab Content Frames
local Tab1Content = Instance.new("Frame")
local Tab2Content = Instance.new("Frame")
local Tab3Content = Instance.new("Frame")

-- Keybind Settings
local ToggleKeybind = Enum.KeyCode.RightShift
local SettingKeybind = false

-- Big Head Settings (from second script)
local HeadSizeEnabled = false
local headScale = Vector3.new(2, 2, 2)
local headTransparency = 0
local headCache = {}

-- Full Bright Settings
local FullBrightEnabled = false
local originalLightingSettings = {}
local originalLightingChildren = {}

-- Remove Fog Settings (NEW)
local RemoveFogEnabled = false
local originalFogSettings = {}

-- FreeCam Settings
local FreeCamEnabled = false
local FreeCamCFrame = nil
local FreeCamSpeed = 3

-- ESP Settings
local l_RunService_0 = RunService
local l_Workspace_0 = Workspace
local l_CurrentCamera_0 = Workspace.CurrentCamera
local v25 = {}
local v26 = false -- Main ESP toggle
local v27 = true -- Distance ESP
local v28 = true -- Player/NPC ESP (Name ESP)
local v29 = false -- Box ESP
local v30 = false -- Sleeper Check
local v31 = false -- Weapon ESP
local v32 = false -- Skeleton ESP
local v33 = Color3.fromRGB(255, 255, 255) -- Box Color
local v34 = Color3.fromRGB(255, 255, 255) -- Name/Text Color
local v35 = Color3.fromRGB(255, 255, 255) -- Skeleton Color

-- Ore ESP Settings
local ESP_ENABLED = {
    Stone = false,
    Iron = false,
    Nitrate = false,
    ShowDistance = false
}
local oreESP = {}
local renderDistance = 750

-- Vehicle ESP Settings
local VehicleESP = {}
local EspEnabled = {
    ATV = false,
    Boat = false,
    Helicopter = false,
    Trolly = false
}
local DistanceESPEnabled = false

-- Weapon definitions
-- Keys = weapon display name you want to show
-- Values = list of part names that reliably exist under HandModel for that weapon
local v47 = {
    -- existing examples
    Bow = {"Arrow", "", ""},
}
local v48 = {}


-- Skeleton bone connections
local v46 = {
    {"Head", "Torso"},
    {"Torso", "LeftUpperArm"},
    {"LeftUpperArm", "LeftLowerArm"},
    {"Torso", "RightUpperArm"},
    {"RightUpperArm", "RightLowerArm"},
    {"LowerTorso", "LeftUpperLeg"},
    {"LeftUpperLeg", "LeftLowerLeg"},
    {"Torso", "LowerTorso"},
    {"RightUpperLeg", "RightLowerLeg"},
    {"LowerTorso", "RightUpperLeg"},
    {"LeftLowerLeg", "LeftFoot"},
    {"RightLowerLeg", "RightFoot"},
    {"RightLowerArm", "RightHand"},
    {"LeftLowerArm", "LeftHand"}
}

-- Loading Text
local LoadingText = Instance.new("TextLabel")
LoadingText.Parent = ScreenGui
LoadingText.BackgroundTransparency = 1
LoadingText.Position = UDim2.new(0.5, -300, 0.5, -75)
LoadingText.Size = UDim2.new(0, 600, 0, 150)
LoadingText.Font = Enum.Font.GothamBold
LoadingText.Text = ""
LoadingText.TextColor3 = Color3.fromRGB(200, 150, 255)
LoadingText.TextSize = 80
LoadingText.ZIndex = 10
LoadingText.TextTransparency = 0

local LoadingStroke = Instance.new("UIStroke")
LoadingStroke.Color = Color3.fromRGB(255, 150, 200)
LoadingStroke.Thickness = 3
LoadingStroke.Parent = LoadingText



-- Main Frame
MainFrame.Name = "MainFrame"
MainFrame.Parent = ScreenGui
MainFrame.BackgroundColor3 = Color3.fromRGB(15, 10, 30)
MainFrame.BorderSizePixel = 0
MainFrame.Position = UDim2.new(0.35, 0, 0.3, 0)
MainFrame.Size = UDim2.new(0, 450, 0, 500)
MainFrame.Active = true
MainFrame.Draggable = true
MainFrame.Visible = false
MainFrame.ClipsDescendants = false

-- Galaxy gradient effect
local Gradient = Instance.new("UIGradient")
Gradient.Color = ColorSequence.new{
    ColorSequenceKeypoint.new(0, Color3.fromRGB(25, 15, 50)),
    ColorSequenceKeypoint.new(0.5, Color3.fromRGB(50, 20, 80)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(30, 10, 60))
}
Gradient.Rotation = 45
Gradient.Parent = MainFrame

UICorner.CornerRadius = UDim.new(0, 12)
UICorner.Parent = MainFrame

local UIStroke = Instance.new("UIStroke")
UIStroke.Color = Color3.fromRGB(100, 60, 150)
UIStroke.Thickness = 2
UIStroke.Transparency = 0.5
UIStroke.Parent = MainFrame

-- Particle effects
for i = 1, 15 do
    local Particle = Instance.new("Frame")
    Particle.Parent = MainFrame
    Particle.BackgroundColor3 = Color3.fromRGB(200, 150, 255)
    Particle.BorderSizePixel = 0
    Particle.Size = UDim2.new(0, math.random(2, 4), 0, math.random(2, 4))
    Particle.Position = UDim2.new(math.random(), 0, math.random(), 0)
    Particle.BackgroundTransparency = math.random(30, 70) / 100
    Particle.ZIndex = 0
    
    local ParticleCorner = Instance.new("UICorner")
    ParticleCorner.CornerRadius = UDim.new(1, 0)
    ParticleCorner.Parent = Particle
    
    task.spawn(function()
        while task.wait(0.03) do
            if not Particle or not Particle.Parent then break end
            local currentPos = Particle.Position
            Particle.Position = UDim2.new(currentPos.X.Scale + 0.002, 0, currentPos.Y.Scale - 0.001, 0)
            
            if Particle.Position.X.Scale > 1.1 or Particle.Position.Y.Scale < -0.1 then
                Particle.Position = UDim2.new(-0.1, 0, math.random(), 0)
            end
        end
    end)
end

-- Top Bar
TopBar.Name = "TopBar"
TopBar.Parent = MainFrame
TopBar.BackgroundColor3 = Color3.fromRGB(10, 5, 20)
TopBar.BorderSizePixel = 0
TopBar.Size = UDim2.new(1, 0, 0, 50)

UICorner2.CornerRadius = UDim.new(0, 12)
UICorner2.Parent = TopBar

-- Logo (CHANGED TO PURPLE PLANET)
Logo.Name = "Logo"
Logo.Parent = TopBar
Logo.BackgroundTransparency = 1
Logo.Position = UDim2.new(0, 10, 0.5, -15)
Logo.Size = UDim2.new(0, 30, 0, 30)
Logo.Image = "rbxassetid://4483345998" -- Planet Icon
Logo.ImageColor3 = Color3.fromRGB(180, 120, 230) -- Tinted Purple

-- Title
Title.Name = "Title"
Title.Parent = TopBar
Title.BackgroundTransparency = 1
Title.Position = UDim2.new(0, 50, 0, 0)
Title.Size = UDim2.new(0, 150, 1, 0)
Title.Font = Enum.Font.GothamBold
Title.Text = "Midnight"
Title.TextColor3 = Color3.fromRGB(220, 180, 255)
Title.TextSize = 24
Title.TextXAlignment = Enum.TextXAlignment.Left

local TitleStroke = Instance.new("UIStroke")
TitleStroke.Color = Color3.fromRGB(80, 40, 120)
TitleStroke.Thickness = 1
TitleStroke.Parent = Title

-- Tab Buttons Frame
TabButtonsFrame.Name = "TabButtonsFrame"
TabButtonsFrame.Parent = TopBar
TabButtonsFrame.BackgroundTransparency = 1
TabButtonsFrame.Position = UDim2.new(0, 160, 0, 7)
TabButtonsFrame.Size = UDim2.new(0, 280, 1, -14)

-- Function to create tab button
local function createTabButton(name, position, parent)
    local button = Instance.new("TextButton")
    button.Name = name
    button.Parent = parent
    button.BackgroundColor3 = Color3.fromRGB(30, 20, 50)
    button.BorderSizePixel = 0
    button.Position = position
    button.Size = UDim2.new(0, 88, 1, 0)
    button.Font = Enum.Font.GothamBold
    button.Text = name
    button.TextColor3 = Color3.fromRGB(200, 160, 240)
    button.TextSize = 15
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 8)
    corner.Parent = button
    
    local stroke = Instance.new("UIStroke")
    stroke.Color = Color3.fromRGB(80, 50, 120)
    stroke.Thickness = 1
    stroke.Transparency = 0.7
    stroke.Parent = button
    
    return button
end

-- Create Tab Buttons
Tab1Button = createTabButton("Main", UDim2.new(0, 0, 0, 0), TabButtonsFrame)
Tab2Button = createTabButton("Player", UDim2.new(0, 94, 0, 0), TabButtonsFrame)
Tab3Button = createTabButton("Misc", UDim2.new(0, 188, 0, 0), TabButtonsFrame)

-- Function to create tab content
local function createTabContent(name, parent)
    local frame = Instance.new("Frame")
    frame.Name = name
    frame.Parent = parent
    frame.BackgroundTransparency = 1
    frame.Position = UDim2.new(0, 15, 0, 65)
    frame.Size = UDim2.new(1, -30, 1, -80)
    frame.Visible = false
    
    local scrollFrame = Instance.new("ScrollingFrame")
    scrollFrame.Parent = frame
    scrollFrame.Size = UDim2.new(1, 0, 1, 0)
    scrollFrame.BackgroundTransparency = 1
    scrollFrame.BorderSizePixel = 0
    scrollFrame.ScrollBarThickness = 4
    scrollFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
    scrollFrame.AutomaticCanvasSize = Enum.AutomaticSize.Y
    
    local listLayout = Instance.new("UIListLayout")
    listLayout.Parent = scrollFrame
    listLayout.SortOrder = Enum.SortOrder.LayoutOrder
    listLayout.Padding = UDim.new(0, 10)
    
    return frame, scrollFrame
end

-- Create Tab Contents
Tab1Content, Tab1Scroll = createTabContent("Tab1Content", MainFrame)
Tab2Content, Tab2Scroll = createTabContent("Tab2Content", MainFrame)
Tab3Content, Tab3Scroll = createTabContent("Tab3Content", MainFrame)

-- ============================================
-- HELPER FUNCTIONS
-- ============================================

local function createFrame(parent, height)
    local frame = Instance.new("Frame")
    frame.Parent = parent
    frame.BackgroundColor3 = Color3.fromRGB(40, 25, 70)
    frame.BorderSizePixel = 0
    frame.Size = UDim2.new(1, 0, 0, height)
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 10)
    corner.Parent = frame
    
    local stroke = Instance.new("UIStroke")
    stroke.Color = Color3.fromRGB(100, 60, 150)
    stroke.Thickness = 2
    stroke.Transparency = 0.6
    stroke.Parent = frame
    
    return frame
end

local function createToggle(name, yPos, parent, defaultState)
    local optionFrame = Instance.new("Frame")
    optionFrame.Parent = parent
    optionFrame.BackgroundTransparency = 1
    optionFrame.Position = UDim2.new(0, 15, 0, yPos)
    optionFrame.Size = UDim2.new(1, -30, 0, 30)
    
    local label = Instance.new("TextLabel")
    label.Parent = optionFrame
    label.BackgroundTransparency = 1
    label.Size = UDim2.new(0.65, 0, 1, 0)
    label.Font = Enum.Font.Gotham
    label.Text = name
    label.TextColor3 = Color3.fromRGB(200, 160, 240)
    label.TextSize = 14
    label.TextXAlignment = Enum.TextXAlignment.Left
    
    local toggleBg = Instance.new("Frame")
    toggleBg.Parent = optionFrame
    toggleBg.BackgroundColor3 = defaultState and Color3.fromRGB(100, 60, 180) or Color3.fromRGB(60, 40, 90)
    toggleBg.BorderSizePixel = 0
    toggleBg.Position = UDim2.new(1, -65, 0.5, -12)
    toggleBg.Size = UDim2.new(0, 50, 0, 24)
    
    local toggleBgCorner = Instance.new("UICorner")
    toggleBgCorner.CornerRadius = UDim.new(1, 0)
    toggleBgCorner.Parent = toggleBg
    
    local toggleCircle = Instance.new("Frame")
    toggleCircle.Parent = toggleBg
    toggleCircle.BackgroundColor3 = defaultState and Color3.fromRGB(200, 160, 240) or Color3.fromRGB(150, 100, 200)
    toggleCircle.BorderSizePixel = 0
    toggleCircle.Position = defaultState and UDim2.new(1, -22, 0.5, -10) or UDim2.new(0, 2, 0.5, -10)
    toggleCircle.Size = UDim2.new(0, 20, 0, 20)
    
    local toggleCircleCorner = Instance.new("UICorner")
    toggleCircleCorner.CornerRadius = UDim.new(1, 0)
    toggleCircleCorner.Parent = toggleCircle
    
    local toggleCircleStroke = Instance.new("UIStroke")
    toggleCircleStroke.Color = Color3.fromRGB(200, 160, 240)
    toggleCircleStroke.Thickness = 2
    toggleCircleStroke.Parent = toggleCircle
    
    local toggleButton = Instance.new("TextButton")
    toggleButton.Parent = toggleBg
    toggleButton.BackgroundTransparency = 1
    toggleButton.Size = UDim2.new(1, 0, 1, 0)
    toggleButton.Text = ""
    
    return {
        Frame = optionFrame,
        ToggleBg = toggleBg,
        ToggleCircle = toggleCircle,
        ToggleButton = toggleButton
    }
end

-- Color Picker Function
local function createColorPicker(parent, callback, defaultColor)
    local ColorFrame = Instance.new("Frame")
    ColorFrame.Parent = ScreenGui
    ColorFrame.BackgroundColor3 = Color3.fromRGB(20, 10, 40)
    ColorFrame.BorderSizePixel = 0
    ColorFrame.Position = UDim2.new(0.5, -100, 0.5, -115)
    ColorFrame.Size = UDim2.new(0, 200, 0, 230)
    ColorFrame.Visible = false
    ColorFrame.ZIndex = 100
    ColorFrame.Active = true
    ColorFrame.Draggable = true
    
    local ColorFrameCorner = Instance.new("UICorner")
    ColorFrameCorner.CornerRadius = UDim.new(0, 10)
    ColorFrameCorner.Parent = ColorFrame
    
    local ColorFrameStroke = Instance.new("UIStroke")
    ColorFrameStroke.Color = Color3.fromRGB(100, 60, 150)
    ColorFrameStroke.Thickness = 2
    ColorFrameStroke.Parent = ColorFrame
    
    local ColorTitle = Instance.new("TextLabel")
    ColorTitle.Parent = ColorFrame
    ColorTitle.BackgroundTransparency = 1
    ColorTitle.Size = UDim2.new(1, 0, 0, 25)
    ColorTitle.Font = Enum.Font.GothamBold
    ColorTitle.Text = "Color Picker"
    ColorTitle.TextColor3 = Color3.fromRGB(220, 180, 255)
    ColorTitle.TextSize = 14
    ColorTitle.ZIndex = 101
    
    local CloseButton = Instance.new("TextButton")
    CloseButton.Parent = ColorFrame
    CloseButton.BackgroundColor3 = Color3.fromRGB(150, 50, 50)
    CloseButton.BorderSizePixel = 0
    CloseButton.Position = UDim2.new(1, -25, 0, 5)
    CloseButton.Size = UDim2.new(0, 20, 0, 20)
    CloseButton.Font = Enum.Font.GothamBold
    CloseButton.Text = "X"
    CloseButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    CloseButton.TextSize = 14
    CloseButton.ZIndex = 101
    
    local CloseCorner = Instance.new("UICorner")
    CloseCorner.CornerRadius = UDim.new(0, 5)
    CloseCorner.Parent = CloseButton
    
    CloseButton.MouseButton1Click:Connect(function()
        ColorFrame.Visible = false
    end)
    
    local ColorWheel = Instance.new("ImageLabel")
    ColorWheel.Parent = ColorFrame
    ColorWheel.BackgroundTransparency = 1
    ColorWheel.Position = UDim2.new(0, 10, 0, 35)
    ColorWheel.Size = UDim2.new(0, 180, 0, 180)
    ColorWheel.Image = "rbxassetid://698052001"
    ColorWheel.ZIndex = 101
    
    local ColorButton = Instance.new("TextButton")
    ColorButton.Parent = ColorWheel
    ColorButton.BackgroundTransparency = 1
    ColorButton.Size = UDim2.new(1, 0, 1, 0)
    ColorButton.Text = ""
    ColorButton.ZIndex = 102
    ColorButton.AutoButtonColor = false
    
    local isDragging = false
    
    local function updateColor(inputPos)
        local relativePos = Vector2.new(
            math.clamp((inputPos.X - ColorWheel.AbsolutePosition.X) / ColorWheel.AbsoluteSize.X, 0, 1),
            math.clamp((inputPos.Y - ColorWheel.AbsolutePosition.Y) / ColorWheel.AbsoluteSize.Y, 0, 1)
        )
        
        local hue = relativePos.X
        local sat = 1 - relativePos.Y
        local color = Color3.fromHSV(hue, sat, 1)
        
        callback(color)
    end
    
    ColorButton.MouseButton1Down:Connect(function()
        isDragging = true
        local mousePos = UserInputService:GetMouseLocation()
        updateColor(mousePos)
    end)
    
    ColorButton.MouseButton1Up:Connect(function()
        isDragging = false
    end)
    
    local moveConnection = UserInputService.InputChanged:Connect(function(input)
        if isDragging and input.UserInputType == Enum.UserInputType.MouseMovement then
            local mousePos = UserInputService:GetMouseLocation()
            updateColor(mousePos)
        end
    end)
    
    local upConnection = UserInputService.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            isDragging = false
        end
    end)
    
    return ColorFrame
end

-- ============================================
-- MAIN TAB - BIG HEAD
-- ============================================

local BigHeadFrame = createFrame(Tab1Scroll, 180)

local BigHeadTitle = Instance.new("TextLabel")
BigHeadTitle.Parent = BigHeadFrame
BigHeadTitle.BackgroundTransparency = 1
BigHeadTitle.Position = UDim2.new(0, 15, 0, 10)
BigHeadTitle.Size = UDim2.new(1, -30, 0, 25)
BigHeadTitle.Font = Enum.Font.GothamBold
BigHeadTitle.Text = "Big Head"
BigHeadTitle.TextColor3 = Color3.fromRGB(220, 180, 255)
BigHeadTitle.TextSize = 18
BigHeadTitle.TextXAlignment = Enum.TextXAlignment.Left

local BigHeadToggle = createToggle("Enable Big Head", 40, BigHeadFrame, false)

-- Head Size Slider
local SizeLabel = Instance.new("TextLabel")
SizeLabel.Parent = BigHeadFrame
SizeLabel.BackgroundTransparency = 1
SizeLabel.Position = UDim2.new(0, 15, 0, 80)
SizeLabel.Size = UDim2.new(0.5, 0, 0, 20)
SizeLabel.Font = Enum.Font.Gotham
SizeLabel.Text = "Head Size: 2x"
SizeLabel.TextColor3 = Color3.fromRGB(200, 160, 240)
SizeLabel.TextSize = 14
SizeLabel.TextXAlignment = Enum.TextXAlignment.Left

local SizeSliderBg = Instance.new("Frame")
SizeSliderBg.Parent = BigHeadFrame
SizeSliderBg.BackgroundColor3 = Color3.fromRGB(20, 10, 40)
SizeSliderBg.BorderSizePixel = 0
SizeSliderBg.Position = UDim2.new(0, 15, 0, 105)
SizeSliderBg.Size = UDim2.new(1, -30, 0, 20)

local SizeSliderBgCorner = Instance.new("UICorner")
SizeSliderBgCorner.CornerRadius = UDim.new(1, 0)
SizeSliderBgCorner.Parent = SizeSliderBg

local SizeSliderFill = Instance.new("Frame")
SizeSliderFill.Parent = SizeSliderBg
SizeSliderFill.BackgroundColor3 = Color3.fromRGB(120, 80, 180)
SizeSliderFill.BorderSizePixel = 0
SizeSliderFill.Size = UDim2.new(0.111, 0, 1, 0)

local SizeSliderFillCorner = Instance.new("UICorner")
SizeSliderFillCorner.CornerRadius = UDim.new(1, 0)
SizeSliderFillCorner.Parent = SizeSliderFill

local SizeSliderButton = Instance.new("TextButton")
SizeSliderButton.Parent = SizeSliderBg
SizeSliderButton.BackgroundColor3 = Color3.fromRGB(180, 120, 230)
SizeSliderButton.BorderSizePixel = 0
SizeSliderButton.Position = UDim2.new(0.111, -10, 0.5, -10)
SizeSliderButton.Size = UDim2.new(0, 20, 0, 20)
SizeSliderButton.Text = ""
SizeSliderButton.AutoButtonColor = false

local SizeSliderButtonCorner = Instance.new("UICorner")
SizeSliderButtonCorner.CornerRadius = UDim.new(1, 0)
SizeSliderButtonCorner.Parent = SizeSliderButton

local SizeSliderButtonStroke = Instance.new("UIStroke")
SizeSliderButtonStroke.Color = Color3.fromRGB(220, 180, 255)
SizeSliderButtonStroke.Thickness = 2
SizeSliderButtonStroke.Parent = SizeSliderButton

-- Head Transparency Slider (FIXED)
local TransLabel = Instance.new("TextLabel")
TransLabel.Parent = BigHeadFrame
TransLabel.BackgroundTransparency = 1
TransLabel.Position = UDim2.new(0, 15, 0, 135)
TransLabel.Size = UDim2.new(0.5, 0, 0, 20)
TransLabel.Font = Enum.Font.Gotham
TransLabel.Text = "Transparency: 0.0"
TransLabel.TextColor3 = Color3.fromRGB(200, 160, 240)
TransLabel.TextSize = 14
TransLabel.TextXAlignment = Enum.TextXAlignment.Left

local TransSliderBg = Instance.new("Frame")
TransSliderBg.Parent = BigHeadFrame
TransSliderBg.BackgroundColor3 = Color3.fromRGB(20, 10, 40)
TransSliderBg.BorderSizePixel = 0
TransSliderBg.Position = UDim2.new(0, 15, 0, 160)
TransSliderBg.Size = UDim2.new(1, -30, 0, 20)

local TransSliderBgCorner = Instance.new("UICorner")
TransSliderBgCorner.CornerRadius = UDim.new(1, 0)
TransSliderBgCorner.Parent = TransSliderBg

local TransSliderFill = Instance.new("Frame")
TransSliderFill.Parent = TransSliderBg
TransSliderFill.BackgroundColor3 = Color3.fromRGB(120, 80, 180)
TransSliderFill.BorderSizePixel = 0
TransSliderFill.Size = UDim2.new(0, 0, 1, 0)

local TransSliderFillCorner = Instance.new("UICorner")
TransSliderFillCorner.CornerRadius = UDim.new(1, 0)
TransSliderFillCorner.Parent = TransSliderFill

local TransSliderButton = Instance.new("TextButton")
TransSliderButton.Parent = TransSliderBg
TransSliderButton.BackgroundColor3 = Color3.fromRGB(180, 120, 230)
TransSliderButton.BorderSizePixel = 0
TransSliderButton.Position = UDim2.new(0, -10, 0.5, -10)
TransSliderButton.Size = UDim2.new(0, 20, 0, 20)
TransSliderButton.Text = ""
TransSliderButton.AutoButtonColor = false

local TransSliderButtonCorner = Instance.new("UICorner")
TransSliderButtonCorner.CornerRadius = UDim.new(1, 0)
TransSliderButtonCorner.Parent = TransSliderButton

local TransSliderButtonStroke = Instance.new("UIStroke")
TransSliderButtonStroke.Color = Color3.fromRGB(220, 180, 255)
TransSliderButtonStroke.Thickness = 2
TransSliderButtonStroke.Parent = TransSliderButton

-- Big Head Logic
local function updateHeadSize(value)
    headScale = Vector3.new(value, value, value)
    SizeLabel.Text = "Head Size: " .. value .. "x"
end

local function updateHeadTransparency(value)
    headTransparency = value
    TransLabel.Text = "Transparency: " .. string.format("%.1f", value)
end

local SizeDragging = false
local function updateSizeSlider(input)
    local pos = math.clamp((input.Position.X - SizeSliderBg.AbsolutePosition.X) / SizeSliderBg.AbsoluteSize.X, 0, 1)
    local value = math.floor(pos * 9) + 1
    
    SizeSliderButton.Position = UDim2.new(pos, -10, 0.5, -10)
    SizeSliderFill.Size = UDim2.new(pos, 0, 1, 0)
    updateHeadSize(value)
end

SizeSliderButton.MouseButton1Down:Connect(function()
    SizeDragging = true
end)

UserInputService.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        SizeDragging = false
        TransDragging = false
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if SizeDragging and input.UserInputType == Enum.UserInputType.MouseMovement then
        updateSizeSlider(input)
    end
    if TransDragging and input.UserInputType == Enum.UserInputType.MouseMovement then
        updateTransSlider(input)
    end
end)

SizeSliderBg.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        updateSizeSlider(input)
    end
end)

local TransDragging = false
local function updateTransSlider(input)
    local pos = math.clamp((input.Position.X - TransSliderBg.AbsolutePosition.X) / TransSliderBg.AbsoluteSize.X, 0, 1)
    
    TransSliderButton.Position = UDim2.new(pos, -10, 0.5, -10)
    TransSliderFill.Size = UDim2.new(pos, 0, 1, 0)
    updateHeadTransparency(pos)
end

TransSliderButton.MouseButton1Down:Connect(function()
    TransDragging = true
end)

TransSliderBg.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        updateTransSlider(input)
    end
end)

local function applyBigHead(character)
    local head = character:FindFirstChild("Head")
    if head and head:IsA("BasePart") then
        if HeadSizeEnabled then
            if not headCache[head] then
                headCache[head] = {
                    Size = head.Size,
                    Transparency = head.Transparency
                }
            end
            head.Size = headScale
            head.Transparency = headTransparency
        elseif headCache[head] then
            head.Size = headCache[head].Size
            head.Transparency = headCache[head].Transparency
            headCache[head] = nil
        end
    end
end

local frameCounter = 0
RunService.RenderStepped:Connect(function()
    frameCounter = frameCounter + 1
    if frameCounter < 25 then return end
    frameCounter = 0
    
    for _, model in pairs(Workspace:GetChildren()) do
        if model:IsA("Model") and model ~= LocalPlayer.Character then
            applyBigHead(model)
        end
    end
end)

BigHeadToggle.ToggleButton.MouseButton1Click:Connect(function()
    HeadSizeEnabled = not HeadSizeEnabled
    
    if HeadSizeEnabled then
        BigHeadToggle.ToggleCircle:TweenPosition(UDim2.new(1, -22, 0.5, -10), "Out", "Quad", 0.2, true)
        BigHeadToggle.ToggleBg.BackgroundColor3 = Color3.fromRGB(100, 60, 180)
        BigHeadToggle.ToggleCircle.BackgroundColor3 = Color3.fromRGB(200, 160, 240)
    else
        BigHeadToggle.ToggleCircle:TweenPosition(UDim2.new(0, 2, 0.5, -10), "Out", "Quad", 0.2, true)
        BigHeadToggle.ToggleBg.BackgroundColor3 = Color3.fromRGB(60, 40, 90)
        BigHeadToggle.ToggleCircle.BackgroundColor3 = Color3.fromRGB(150, 100, 200)
        
        for head, data in pairs(headCache) do
            if head and head.Parent then
                head.Size = data.Size
                head.Transparency = data.Transparency
            end
        end
        headCache = {}
    end
end)

-- ============================================
-- ESP HELPER FUNCTIONS
-- ============================================

local function v52(v49)
    local l_Head_1 = v49:FindFirstChild("Head")
    local v51 = v49:FindFirstChild("Torso") or v49:FindFirstChild("UpperTorso") or v49:FindFirstChild("LowerTorso")
    if l_Head_1 and v51 then
        return l_Head_1, v51
    else
        return
    end
end

local function v55(v53)
    local l_Torso_0 = v53:FindFirstChild("Torso")
    if l_Torso_0 and l_Torso_0:FindFirstChild("LeftBooster") then
        return true
    else
        return false
    end
end

local function v65(v56)
    local l_HandModel_0 = v56:FindFirstChild("HandModel")
    if not l_HandModel_0 then
        return "None"
    else
        -- Try to find the weapon name
        for weaponName, parts in pairs(v47) do
            local hasAllParts = true
            for _, partName in ipairs(parts) do
                if not l_HandModel_0:FindFirstChild(partName) then
                    hasAllParts = false
                    break
                end
            end
            if hasAllParts then
                return weaponName
            end
        end
        
        -- If no match found, try to get first child name
        local firstChild = l_HandModel_0:FindFirstChildWhichIsA("BasePart") or l_HandModel_0:FindFirstChildWhichIsA("Model")
        if firstChild then
            return firstChild.Name
        end
        
        return "Weapon"
    end
end

local function v80(v66)
    if v25[v66] then
        return
    else
        local v67, v68 = v52(v66)
        if not v67 or not v68 then
            return
        else
            local v69 = Drawing.new("Square")
            v69.Thickness = 1
            v69.Filled = false
            v69.Color = v33
            v69.Visible = false
            
            local v70 = Drawing.new("Square")
            v70.Thickness = 1
            v70.Filled = false
            v70.Color = Color3.fromRGB(0, 0, 0)
            v70.Visible = false
            
            local v71 = Drawing.new("Text")
            v71.Size = 16
            v71.Center = true
            v71.Outline = true
            v71.OutlineColor = Color3.new(0, 0, 0)
            v71.Visible = false
            
            local v72 = Drawing.new("Text")
            v72.Size = 16
            v72.Center = true
            v72.Outline = true
            v72.OutlineColor = Color3.new(0, 0, 0)
            v72.Visible = false
            
            local v73 = {}
            for _, v75 in ipairs(v46) do
                local v76 = Drawing.new("Line")
                v76.Color = v55(v66) and v35 or Color3.fromRGB(0, 150, 255)
                v76.Thickness = 1.5
                v76.Visible = false
                table.insert(v73, {
                    line = v76,
                    a = v75[1],
                    b = v75[2]
                })
            end
            
            v25[v66] = {
                box = v69,
                outline = v70,
                text = v71,
                weaponText = v72,
                head = v67,
                torso = v68,
                skeletonLines = v73
            }
            
            v66.Destroying:Connect(function()
                pcall(function() v69:Remove() end)
                pcall(function() v70:Remove() end)
                pcall(function() v71:Remove() end)
                pcall(function() v72:Remove() end)
                for _, v78 in ipairs(v73) do
                    pcall(function() v78.line:Remove() end)
                end
                v25[v66] = nil
            end)
            return
        end
    end
end

for _, v82 in ipairs(l_Workspace_0:GetChildren()) do
    if v82:IsA("Model") then
        v80(v82)
    end
end

l_Workspace_0.ChildAdded:Connect(function(v83)
    if v83:IsA("Model") then
        v80(v83)
    end
end)

task.spawn(function()
    while true do
        for v84 in pairs(v25) do
            v48[v84] = v65(v84)
        end
        task.wait(1)
    end
end)

-- ESP Render Loop
l_RunService_0.RenderStepped:Connect(function()
    if not v26 then
        return
    end
    
    local l_Position_0 = l_CurrentCamera_0.CFrame.Position
    for v94, v95 in pairs(v25) do
        local v96 = true
        local l_head_0 = v95.head
        local l_torso_0 = v95.torso
        
        if not l_head_0 or not l_torso_0 or not l_head_0.Parent or not l_torso_0.Parent then
            local v99, v100 = v52(v94)
            l_torso_0 = v100
            l_head_0 = v99
            v95.torso = l_torso_0
            v95.head = l_head_0
            if not l_head_0 or not l_torso_0 then
                v96 = false
            end
        end
        
        -- Sleeper Check
        if v96 and v30 then
            local l_LowerTorso_0 = v94:FindFirstChild("LowerTorso")
            if l_LowerTorso_0 then
                local l_RootRig_0 = l_LowerTorso_0:FindFirstChild("RootRig")
                if l_RootRig_0 and typeof(l_RootRig_0.CurrentAngle) == "number" and l_RootRig_0.CurrentAngle ~= 0 then
                    v96 = false
                end
            end
        end
        
        local v103 = nil
        local v104 = nil
        if v96 then
            v103 = (l_head_0.Position + l_torso_0.Position) * 0.5
            v104 = (v103 - l_Position_0).Magnitude
            if v104 >= 3000 then
                v96 = false
            end
        end
        
        local v105 = nil
        local v106 = nil
        if v96 then
            local v107, v108 = l_CurrentCamera_0:WorldToViewportPoint(v103)
            v106 = v108
            v105 = v107
            if not v106 then
                v96 = false
            end
        end
        
        if not v96 then
            v95.box.Visible = false
            v95.outline.Visible = false
            v95.text.Visible = false
            v95.weaponText.Visible = false
            for _, v110 in ipairs(v95.skeletonLines) do
                v110.line.Visible = false
            end
        else
            local v111 = 1000 / (v104 * 2) / math.tan(math.rad(l_CurrentCamera_0.FieldOfView / 1.7))
            local v112 = math.clamp(math.floor(6.5 * v111), 10, 600)
            local v113 = math.clamp(math.floor(9.5 * v111), 14, 800)
            local v114 = v105.X - v112 / 2
            local v115 = v105.Y - v113 / 3.5
            
            if v29 then
                local v116 = 2
                v95.outline.Size = Vector2.new(v112 + v116, v113 + v116)
                v95.outline.Position = Vector2.new(v114 - v116 / 2, v115 - v116 / 2)
                v95.outline.Visible = true
                v95.box.Size = Vector2.new(v112, v113)
                v95.box.Position = Vector2.new(v114, v115)
                v95.box.Color = v55(v94) and v33 or Color3.fromRGB(0, 150, 255)
                v95.box.Visible = true
            else
                v95.outline.Visible = false
                v95.box.Visible = false
            end
            
            local v117 = {}
            if v28 then
                -- Changed "Bot" to "NPC"
                table.insert(v117, v55(v94) and "Player" or "NPC")
            end
            if v27 then
                table.insert(v117, math.floor(v104) .. "m")
            end
            local v118 = table.concat(v117, " | ")
            if v118 ~= "" then
                v95.text.Color = v55(v94) and v34 or Color3.fromRGB(0, 150, 255)
                v95.text.Text = v118
                v95.text.Position = Vector2.new(v105.X, v115 - 16)
                v95.text.Visible = true
            else
                v95.text.Visible = false
            end
            
            if v31 then
                local v119 = v48[v94] or "None"
                v95.weaponText.Color = v55(v94) and v34 or Color3.fromRGB(0, 150, 255)
                v95.weaponText.Text = v119
                v95.weaponText.Position = Vector2.new(v105.X, v115 + v113)
                v95.weaponText.Visible = true
            else
                v95.weaponText.Visible = false
            end
            
            if v32 then
                for _, v121 in ipairs(v95.skeletonLines) do
                    local l_v94_FirstChild_0 = v94:FindFirstChild(v121.a)
                    local l_v94_FirstChild_1 = v94:FindFirstChild(v121.b)
                    if l_v94_FirstChild_0 and l_v94_FirstChild_1 then
                        local v124, v125 = l_CurrentCamera_0:WorldToViewportPoint(l_v94_FirstChild_0.Position)
                        local v126, v127 = l_CurrentCamera_0:WorldToViewportPoint(l_v94_FirstChild_1.Position)
                        if v125 and v127 then
                            v121.line.From = Vector2.new(v124.X, v124.Y)
                            v121.line.To = Vector2.new(v126.X, v126.Y)
                            v121.line.Color = v35
                            v121.line.Visible = true
                        else
                            v121.line.Visible = false
                        end
                    else
                        v121.line.Visible = false
                    end
                end
            else
                for _, v129 in ipairs(v95.skeletonLines) do
                    v129.line.Visible = false
                end
            end
        end
    end
end)

-- ============================================
-- MAIN TAB - ESP TOGGLES
-- ============================================

local ESPFrame = createFrame(Tab1Scroll, 380)

local ESPTitle = Instance.new("TextLabel")
ESPTitle.Parent = ESPFrame
ESPTitle.BackgroundTransparency = 1
ESPTitle.Position = UDim2.new(0, 15, 0, 10)
ESPTitle.Size = UDim2.new(1, -30, 0, 25)
ESPTitle.Font = Enum.Font.GothamBold
ESPTitle.Text = "ESP Settings"
ESPTitle.TextColor3 = Color3.fromRGB(220, 180, 255)
ESPTitle.TextSize = 18
ESPTitle.TextXAlignment = Enum.TextXAlignment.Left

-- Create all ESP toggles
local SkeletonToggle = createToggle("Skeleton ESP", 40, ESPFrame, false)
local WeaponToggle = createToggle("Weapon ESP", 75, ESPFrame, false)
local SleeperToggle = createToggle("Sleeper Check", 110, ESPFrame, false)
local BoxToggle = createToggle("Box ESP", 145, ESPFrame, false)
local DistanceToggle = createToggle("Distance ESP", 180, ESPFrame, true)
local NameToggle = createToggle("Name ESP", 215, ESPFrame, true)

-- Color Buttons for ESP
local SkeletonColorBtn = Instance.new("TextButton")
SkeletonColorBtn.Parent = SkeletonToggle.Frame
SkeletonColorBtn.BackgroundColor3 = v35
SkeletonColorBtn.BorderSizePixel = 0
SkeletonColorBtn.Position = UDim2.new(1, -125, 0.5, -12)
SkeletonColorBtn.Size = UDim2.new(0, 50, 0, 24)
SkeletonColorBtn.Text = "Color"
SkeletonColorBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
SkeletonColorBtn.Font = Enum.Font.GothamBold
SkeletonColorBtn.TextSize = 11

local SkeletonColorCorner = Instance.new("UICorner")
SkeletonColorCorner.CornerRadius = UDim.new(0, 6)
SkeletonColorCorner.Parent = SkeletonColorBtn

local BoxColorBtn = Instance.new("TextButton")
BoxColorBtn.Parent = BoxToggle.Frame
BoxColorBtn.BackgroundColor3 = v33
BoxColorBtn.BorderSizePixel = 0
BoxColorBtn.Position = UDim2.new(1, -125, 0.5, -12)
BoxColorBtn.Size = UDim2.new(0, 50, 0, 24)
BoxColorBtn.Text = "Color"
BoxColorBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
BoxColorBtn.Font = Enum.Font.GothamBold
BoxColorBtn.TextSize = 11

local BoxColorCorner = Instance.new("UICorner")
BoxColorCorner.CornerRadius = UDim.new(0, 6)
BoxColorCorner.Parent = BoxColorBtn

local NameColorBtn = Instance.new("TextButton")
NameColorBtn.Parent = NameToggle.Frame
NameColorBtn.BackgroundColor3 = v34
NameColorBtn.BorderSizePixel = 0
NameColorBtn.Position = UDim2.new(1, -125, 0.5, -12)
NameColorBtn.Size = UDim2.new(0, 50, 0, 24)
NameColorBtn.Text = "Color"
NameColorBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
NameColorBtn.Font = Enum.Font.GothamBold
NameColorBtn.TextSize = 11

local NameColorCorner = Instance.new("UICorner")
NameColorCorner.CornerRadius = UDim.new(0, 6)
NameColorCorner.Parent = NameColorBtn

-- Create Color Pickers
local SkeletonColorPicker = createColorPicker(nil, function(color)
    v35 = color
    SkeletonColorBtn.BackgroundColor3 = color
end, v35)

local BoxColorPicker = createColorPicker(nil, function(color)
    v33 = color
    BoxColorBtn.BackgroundColor3 = color
end, v33)

local NameColorPicker = createColorPicker(nil, function(color)
    v34 = color
    NameColorBtn.BackgroundColor3 = color
end, v34)

-- Color Button Click Events
SkeletonColorBtn.MouseButton1Click:Connect(function()
    SkeletonColorPicker.Visible = not SkeletonColorPicker.Visible
    BoxColorPicker.Visible = false
    NameColorPicker.Visible = false
end)

BoxColorBtn.MouseButton1Click:Connect(function()
    BoxColorPicker.Visible = not BoxColorPicker.Visible
    SkeletonColorPicker.Visible = false
    NameColorPicker.Visible = false
end)

NameColorBtn.MouseButton1Click:Connect(function()
    NameColorPicker.Visible = not NameColorPicker.Visible
    SkeletonColorPicker.Visible = false
    BoxColorPicker.Visible = false
end)

-- Toggle connections
SkeletonToggle.ToggleButton.MouseButton1Click:Connect(function()
    v32 = not v32
    if v32 then
        SkeletonToggle.ToggleCircle:TweenPosition(UDim2.new(1, -22, 0.5, -10), "Out", "Quad", 0.2, true)
        SkeletonToggle.ToggleBg.BackgroundColor3 = Color3.fromRGB(100, 60, 180)
        SkeletonToggle.ToggleCircle.BackgroundColor3 = Color3.fromRGB(200, 160, 240)
    else
        SkeletonToggle.ToggleCircle:TweenPosition(UDim2.new(0, 2, 0.5, -10), "Out", "Quad", 0.2, true)
        SkeletonToggle.ToggleBg.BackgroundColor3 = Color3.fromRGB(60, 40, 90)
        SkeletonToggle.ToggleCircle.BackgroundColor3 = Color3.fromRGB(150, 100, 200)
    end
end)

WeaponToggle.ToggleButton.MouseButton1Click:Connect(function()
    v31 = not v31
    if v31 then
        WeaponToggle.ToggleCircle:TweenPosition(UDim2.new(1, -22, 0.5, -10), "Out", "Quad", 0.2, true)
        WeaponToggle.ToggleBg.BackgroundColor3 = Color3.fromRGB(100, 60, 180)
        WeaponToggle.ToggleCircle.BackgroundColor3 = Color3.fromRGB(200, 160, 240)
        v26 = true
    else
        WeaponToggle.ToggleCircle:TweenPosition(UDim2.new(0, 2, 0.5, -10), "Out", "Quad", 0.2, true)
        WeaponToggle.ToggleBg.BackgroundColor3 = Color3.fromRGB(60, 40, 90)
        WeaponToggle.ToggleCircle.BackgroundColor3 = Color3.fromRGB(150, 100, 200)
    end
end)

SleeperToggle.ToggleButton.MouseButton1Click:Connect(function()
    v30 = not v30
    if v30 then
        SleeperToggle.ToggleCircle:TweenPosition(UDim2.new(1, -22, 0.5, -10), "Out", "Quad", 0.2, true)
        SleeperToggle.ToggleBg.BackgroundColor3 = Color3.fromRGB(100, 60, 180)
        SleeperToggle.ToggleCircle.BackgroundColor3 = Color3.fromRGB(200, 160, 240)
    else
        SleeperToggle.ToggleCircle:TweenPosition(UDim2.new(0, 2, 0.5, -10), "Out", "Quad", 0.2, true)
        SleeperToggle.ToggleBg.BackgroundColor3 = Color3.fromRGB(60, 40, 90)
        SleeperToggle.ToggleCircle.BackgroundColor3 = Color3.fromRGB(150, 100, 200)
    end
end)

BoxToggle.ToggleButton.MouseButton1Click:Connect(function()
    v29 = not v29
    v26 = v29 or v31 or v32
    if v29 then
        BoxToggle.ToggleCircle:TweenPosition(UDim2.new(1, -22, 0.5, -10), "Out", "Quad", 0.2, true)
        BoxToggle.ToggleBg.BackgroundColor3 = Color3.fromRGB(100, 60, 180)
        BoxToggle.ToggleCircle.BackgroundColor3 = Color3.fromRGB(200, 160, 240)
    else
        BoxToggle.ToggleCircle:TweenPosition(UDim2.new(0, 2, 0.5, -10), "Out", "Quad", 0.2, true)
        BoxToggle.ToggleBg.BackgroundColor3 = Color3.fromRGB(60, 40, 90)
        BoxToggle.ToggleCircle.BackgroundColor3 = Color3.fromRGB(150, 100, 200)
    end
end)

DistanceToggle.ToggleButton.MouseButton1Click:Connect(function()
    v27 = not v27
    if v27 then
        DistanceToggle.ToggleCircle:TweenPosition(UDim2.new(1, -22, 0.5, -10), "Out", "Quad", 0.2, true)
        DistanceToggle.ToggleBg.BackgroundColor3 = Color3.fromRGB(100, 60, 180)
        DistanceToggle.ToggleCircle.BackgroundColor3 = Color3.fromRGB(200, 160, 240)
    else
        DistanceToggle.ToggleCircle:TweenPosition(UDim2.new(0, 2, 0.5, -10), "Out", "Quad", 0.2, true)
        DistanceToggle.ToggleBg.BackgroundColor3 = Color3.fromRGB(60, 40, 90)
        DistanceToggle.ToggleCircle.BackgroundColor3 = Color3.fromRGB(150, 100, 200)
    end
end)

NameToggle.ToggleButton.MouseButton1Click:Connect(function()
    v28 = not v28
    if v28 then
        NameToggle.ToggleCircle:TweenPosition(UDim2.new(1, -22, 0.5, -10), "Out", "Quad", 0.2, true)
        NameToggle.ToggleBg.BackgroundColor3 = Color3.fromRGB(100, 60, 180)
        NameToggle.ToggleCircle.BackgroundColor3 = Color3.fromRGB(200, 160, 240)
    else
        NameToggle.ToggleCircle:TweenPosition(UDim2.new(0, 2, 0.5, -10), "Out", "Quad", 0.2, true)
        NameToggle.ToggleBg.BackgroundColor3 = Color3.fromRGB(60, 40, 90)
        NameToggle.ToggleCircle.BackgroundColor3 = Color3.fromRGB(150, 100, 200)
    end
end)

-- ============================================
-- MAIN TAB - ORE ESP
-- ============================================

local OreESPFrame = createFrame(Tab1Scroll, 220)

local OreTitle = Instance.new("TextLabel")
OreTitle.Parent = OreESPFrame
OreTitle.BackgroundTransparency = 1
OreTitle.Position = UDim2.new(0, 15, 0, 10)
OreTitle.Size = UDim2.new(1, -30, 0, 25)
OreTitle.Font = Enum.Font.GothamBold
OreTitle.Text = "Ore ESP"
OreTitle.TextColor3 = Color3.fromRGB(220, 180, 255)
OreTitle.TextSize = 18
OreTitle.TextXAlignment = Enum.TextXAlignment.Left

local StoneToggle = createToggle("Stone ESP", 40, OreESPFrame, false)
local IronToggle = createToggle("Iron ESP", 75, OreESPFrame, false)
local NitrateToggle = createToggle("Nitrate ESP", 110, OreESPFrame, false)
local ShowDistToggle = createToggle("Show Distance", 145, OreESPFrame, false)

-- Distance Slider
local DistLabel = Instance.new("TextLabel")
DistLabel.Parent = OreESPFrame
DistLabel.BackgroundTransparency = 1
DistLabel.Position = UDim2.new(0, 15, 0, 180)
DistLabel.Size = UDim2.new(0.5, 0, 0, 20)
DistLabel.Font = Enum.Font.Gotham
DistLabel.Text = "Distance: 750m"
DistLabel.TextColor3 = Color3.fromRGB(200, 160, 240)
DistLabel.TextSize = 14
DistLabel.TextXAlignment = Enum.TextXAlignment.Left

-- Ore ESP Logic
local v269 = {
    Stone = {Color3.fromRGB(72, 72, 72)},
    Iron = {Color3.fromRGB(72, 72, 72), Color3.fromRGB(199, 172, 120)},
    Nitrate = {Color3.fromRGB(248, 248, 248), Color3.fromRGB(72, 72, 72)}
}

local v270 = {
    Stone = Color3.fromRGB(120, 120, 120),
    Iron = Color3.fromRGB(255, 215, 0),
    Nitrate = Color3.fromRGB(200, 255, 200)
}

local function v273(v271, v272)
    return math.abs(v271.R - v272.R) < 0.02 and math.abs(v271.G - v272.G) < 0.02 and math.abs(v271.B - v272.B) < 0.02
end

local function v281(v274)
    local v275 = {}
    for _, v277 in ipairs(v274:GetChildren()) do
        if v277:IsA("MeshPart") then
            table.insert(v275, v277)
        end
    end
    if #v275 == 1 then
        local l_Color_0 = v275[1].Color
        if v273(l_Color_0, v269.Stone[1]) then
            return "Stone", v275[1]
        end
    elseif #v275 == 2 then
        local l_Color_1 = v275[1].Color
        local l_Color_2 = v275[2].Color
        if v273(l_Color_1, v269.Iron[1]) and v273(l_Color_2, v269.Iron[2]) or v273(l_Color_1, v269.Iron[2]) and v273(l_Color_2, v269.Iron[1]) then
            return "Iron", v275[1]
        elseif v273(l_Color_1, v269.Nitrate[1]) and v273(l_Color_2, v269.Nitrate[2]) or v273(l_Color_1, v269.Nitrate[2]) and v273(l_Color_2, v269.Nitrate[1]) then
            return "Nitrate", v275[1]
        end
    end
    return nil
end

local function v286(v282, v283, v284)
    local v285 = Drawing.new("Text")
    v285.Text = v283
    v285.Size = 16
    v285.Center = true
    v285.Outline = true
    v285.Color = v270[v283]
    v285.Visible = true
    oreESP[v282] = {
        Text = v285,
        OreType = v283,
        Part = v284
    }
end

local function v288(v287)
    if oreESP[v287] then
        oreESP[v287].Text:Remove()
        oreESP[v287] = nil
    end
end

task.spawn(function()
    while true do
        for _, v290 in ipairs(Workspace:GetChildren()) do
            if v290:IsA("Model") and not oreESP[v290] then
                local v291, v292 = v281(v290)
                if v291 and ESP_ENABLED[v291] then
                    v286(v290, v291, v292)
                end
            end
        end
        for v293 in pairs(oreESP) do
            if not v293.Parent then
                v288(v293)
            end
        end
        task.wait(2)
    end
end)

RunService.RenderStepped:Connect(function()
    for v294, v295 in pairs(oreESP) do
        local l_Part_1 = v295.Part
        if l_Part_1 and l_Part_1.Parent then
            local l_Magnitude_1 = (l_CurrentCamera_0.CFrame.Position - l_Part_1.Position).Magnitude
            local v298, v299 = l_CurrentCamera_0:WorldToViewportPoint(l_Part_1.Position)
            if v299 and l_Magnitude_1 <= renderDistance and ESP_ENABLED[v295.OreType] then
                local l_Text_0 = v295.Text
                if ESP_ENABLED.ShowDistance then
                    l_Text_0.Text = string.format("%s | %.0fm", v295.OreType, l_Magnitude_1)
                else
                    l_Text_0.Text = v295.OreType
                end
                l_Text_0.Position = Vector2.new(v298.X, v298.Y)
                l_Text_0.Visible = true
            else
                v295.Text.Visible = false
            end
        else
            v288(v294)
        end
    end
end)

-- Ore ESP Toggle Connections
StoneToggle.ToggleButton.MouseButton1Click:Connect(function()
    ESP_ENABLED.Stone = not ESP_ENABLED.Stone
    if ESP_ENABLED.Stone then
        StoneToggle.ToggleCircle:TweenPosition(UDim2.new(1, -22, 0.5, -10), "Out", "Quad", 0.2, true)
        StoneToggle.ToggleBg.BackgroundColor3 = Color3.fromRGB(100, 60, 180)
        StoneToggle.ToggleCircle.BackgroundColor3 = Color3.fromRGB(200, 160, 240)
    else
        StoneToggle.ToggleCircle:TweenPosition(UDim2.new(0, 2, 0.5, -10), "Out", "Quad", 0.2, true)
        StoneToggle.ToggleBg.BackgroundColor3 = Color3.fromRGB(60, 40, 90)
        StoneToggle.ToggleCircle.BackgroundColor3 = Color3.fromRGB(150, 100, 200)
    end
end)

IronToggle.ToggleButton.MouseButton1Click:Connect(function()
    ESP_ENABLED.Iron = not ESP_ENABLED.Iron
    if ESP_ENABLED.Iron then
        IronToggle.ToggleCircle:TweenPosition(UDim2.new(1, -22, 0.5, -10), "Out", "Quad", 0.2, true)
        IronToggle.ToggleBg.BackgroundColor3 = Color3.fromRGB(100, 60, 180)
        IronToggle.ToggleCircle.BackgroundColor3 = Color3.fromRGB(200, 160, 240)
    else
        IronToggle.ToggleCircle:TweenPosition(UDim2.new(0, 2, 0.5, -10), "Out", "Quad", 0.2, true)
        IronToggle.ToggleBg.BackgroundColor3 = Color3.fromRGB(60, 40, 90)
        IronToggle.ToggleCircle.BackgroundColor3 = Color3.fromRGB(150, 100, 200)
    end
end)

NitrateToggle.ToggleButton.MouseButton1Click:Connect(function()
    ESP_ENABLED.Nitrate = not ESP_ENABLED.Nitrate
    if ESP_ENABLED.Nitrate then
        NitrateToggle.ToggleCircle:TweenPosition(UDim2.new(1, -22, 0.5, -10), "Out", "Quad", 0.2, true)
        NitrateToggle.ToggleBg.BackgroundColor3 = Color3.fromRGB(100, 60, 180)
        NitrateToggle.ToggleCircle.BackgroundColor3 = Color3.fromRGB(200, 160, 240)
    else
        NitrateToggle.ToggleCircle:TweenPosition(UDim2.new(0, 2, 0.5, -10), "Out", "Quad", 0.2, true)
        NitrateToggle.ToggleBg.BackgroundColor3 = Color3.fromRGB(60, 40, 90)
        NitrateToggle.ToggleCircle.BackgroundColor3 = Color3.fromRGB(150, 100, 200)
    end
end)

ShowDistToggle.ToggleButton.MouseButton1Click:Connect(function()
    ESP_ENABLED.ShowDistance = not ESP_ENABLED.ShowDistance
    if ESP_ENABLED.ShowDistance then
        ShowDistToggle.ToggleCircle:TweenPosition(UDim2.new(1, -22, 0.5, -10), "Out", "Quad", 0.2, true)
        ShowDistToggle.ToggleBg.BackgroundColor3 = Color3.fromRGB(100, 60, 180)
        ShowDistToggle.ToggleCircle.BackgroundColor3 = Color3.fromRGB(200, 160, 240)
    else
        ShowDistToggle.ToggleCircle:TweenPosition(UDim2.new(0, 2, 0.5, -10), "Out", "Quad", 0.2, true)
        ShowDistToggle.ToggleBg.BackgroundColor3 = Color3.fromRGB(60, 40, 90)
        ShowDistToggle.ToggleCircle.BackgroundColor3 = Color3.fromRGB(150, 100, 200)
    end
end)

-- ============================================
-- MAIN TAB - VEHICLE ESP
-- ============================================

local VehicleESPFrame = createFrame(Tab1Scroll, 180)

local VehicleTitle = Instance.new("TextLabel")
VehicleTitle.Parent = VehicleESPFrame
VehicleTitle.BackgroundTransparency = 1
VehicleTitle.Position = UDim2.new(0, 15, 0, 10)
VehicleTitle.Size = UDim2.new(1, -30, 0, 25)
VehicleTitle.Font = Enum.Font.GothamBold
VehicleTitle.Text = "Vehicle ESP"
VehicleTitle.TextColor3 = Color3.fromRGB(220, 180, 255)
VehicleTitle.TextSize = 18
VehicleTitle.TextXAlignment = Enum.TextXAlignment.Left

local ATVToggle = createToggle("ATV ESP", 40, VehicleESPFrame, false)
local BoatToggle = createToggle("Boat ESP", 75, VehicleESPFrame, false)
local HeliToggle = createToggle("Helicopter ESP", 110, VehicleESPFrame, false)
local VehicleDistToggle = createToggle("Show Distance", 145, VehicleESPFrame, false)

-- Vehicle ESP Logic
local l_vehicles_0 = ReplicatedStorage.Shared.entities.vehicles
local VehicleBlueprints = {
    ATV = l_vehicles_0.ATV.Model,
    Boat = l_vehicles_0.Boat.Model,
    Helicopter = l_vehicles_0.Helicopter.Model,
    Trolly = l_vehicles_0.Trolly.Model
}

local function v310(v306, v307)
    for _, v309 in ipairs(v307:GetChildren()) do
        if not v306:FindFirstChild(v309.Name) then
            return false
        end
    end
    return true
end

local function v314(v311, v312)
    local v313 = Drawing.new("Text")
    v313.Size = 18
    v313.Color = Color3.fromRGB(0, 255, 0)
    v313.Center = true
    v313.Outline = true
    v313.Visible = true
    VehicleESP[v311] = {
        Drawing = v313,
        Name = v312
    }
end

local function v316(v315)
    if VehicleESP[v315] then
        VehicleESP[v315].Drawing:Remove()
        VehicleESP[v315] = nil
    end
end

local v317 = 0
RunService.RenderStepped:Connect(function()
    v317 = v317 + 1
    if v317 % 500 == 0 then
        for _, v320 in ipairs(Workspace:GetChildren()) do
            if v320:IsA("Model") and not VehicleESP[v320] then
                for v321, v322 in pairs(VehicleBlueprints) do
                    if EspEnabled[v321] and v310(v320, v322) then
                        v314(v320, v321)
                        break
                    end
                end
            end
        end
        for v323, _ in pairs(VehicleESP) do
            if not v323.Parent then
                v316(v323)
            end
        end
    end
    
    for v325, v326 in pairs(VehicleESP) do
        local l_Drawing_0 = v326.Drawing
        local l_Name_0 = v326.Name
        if EspEnabled[l_Name_0] and v325.PrimaryPart then
            local v329, v330 = l_CurrentCamera_0:WorldToViewportPoint(v325.PrimaryPart.Position)
            if v330 then
                local v331 = math.floor((v325.PrimaryPart.Position - l_CurrentCamera_0.CFrame.Position).Magnitude)
                if DistanceESPEnabled then
                    l_Drawing_0.Text = string.format("%s | %dm", l_Name_0, v331)
                else
                    l_Drawing_0.Text = l_Name_0
                end
                l_Drawing_0.Position = Vector2.new(v329.X, v329.Y)
                l_Drawing_0.Visible = true
            else
                l_Drawing_0.Visible = false
            end
        else
            l_Drawing_0.Visible = false
        end
    end
end)

-- Vehicle ESP Toggle Connections
ATVToggle.ToggleButton.MouseButton1Click:Connect(function()
    EspEnabled.ATV = not EspEnabled.ATV
    if EspEnabled.ATV then
        ATVToggle.ToggleCircle:TweenPosition(UDim2.new(1, -22, 0.5, -10), "Out", "Quad", 0.2, true)
        ATVToggle.ToggleBg.BackgroundColor3 = Color3.fromRGB(100, 60, 180)
        ATVToggle.ToggleCircle.BackgroundColor3 = Color3.fromRGB(200, 160, 240)
    else
        ATVToggle.ToggleCircle:TweenPosition(UDim2.new(0, 2, 0.5, -10), "Out", "Quad", 0.2, true)
        ATVToggle.ToggleBg.BackgroundColor3 = Color3.fromRGB(60, 40, 90)
        ATVToggle.ToggleCircle.BackgroundColor3 = Color3.fromRGB(150, 100, 200)
    end
end)

BoatToggle.ToggleButton.MouseButton1Click:Connect(function()
    EspEnabled.Boat = not EspEnabled.Boat
    if EspEnabled.Boat then
        BoatToggle.ToggleCircle:TweenPosition(UDim2.new(1, -22, 0.5, -10), "Out", "Quad", 0.2, true)
        BoatToggle.ToggleBg.BackgroundColor3 = Color3.fromRGB(100, 60, 180)
        BoatToggle.ToggleCircle.BackgroundColor3 = Color3.fromRGB(200, 160, 240)
    else
        BoatToggle.ToggleCircle:TweenPosition(UDim2.new(0, 2, 0.5, -10), "Out", "Quad", 0.2, true)
        BoatToggle.ToggleBg.BackgroundColor3 = Color3.fromRGB(60, 40, 90)
        BoatToggle.ToggleCircle.BackgroundColor3 = Color3.fromRGB(150, 100, 200)
    end
end)

HeliToggle.ToggleButton.MouseButton1Click:Connect(function()
    EspEnabled.Helicopter = not EspEnabled.Helicopter
    if EspEnabled.Helicopter then
        HeliToggle.ToggleCircle:TweenPosition(UDim2.new(1, -22, 0.5, -10), "Out", "Quad", 0.2, true)
        HeliToggle.ToggleBg.BackgroundColor3 = Color3.fromRGB(100, 60, 180)
        HeliToggle.ToggleCircle.BackgroundColor3 = Color3.fromRGB(200, 160, 240)
    else
        HeliToggle.ToggleCircle:TweenPosition(UDim2.new(0, 2, 0.5, -10), "Out", "Quad", 0.2, true)
        HeliToggle.ToggleBg.BackgroundColor3 = Color3.fromRGB(60, 40, 90)
        HeliToggle.ToggleCircle.BackgroundColor3 = Color3.fromRGB(150, 100, 200)
    end
end)

VehicleDistToggle.ToggleButton.MouseButton1Click:Connect(function()
    DistanceESPEnabled = not DistanceESPEnabled
    if DistanceESPEnabled then
        VehicleDistToggle.ToggleCircle:TweenPosition(UDim2.new(1, -22, 0.5, -10), "Out", "Quad", 0.2, true)
        VehicleDistToggle.ToggleBg.BackgroundColor3 = Color3.fromRGB(100, 60, 180)
        VehicleDistToggle.ToggleCircle.BackgroundColor3 = Color3.fromRGB(200, 160, 240)
    else
        VehicleDistToggle.ToggleCircle:TweenPosition(UDim2.new(0, 2, 0.5, -10), "Out", "Quad", 0.2, true)
        VehicleDistToggle.ToggleBg.BackgroundColor3 = Color3.fromRGB(60, 40, 90)
        VehicleDistToggle.ToggleCircle.BackgroundColor3 = Color3.fromRGB(150, 100, 200)
    end
end)

-- ============================================
-- PLAYER TAB - COMING SOON
-- ============================================

local ComingSoonLabel = Instance.new("TextLabel")
ComingSoonLabel.Parent = Tab2Scroll
ComingSoonLabel.BackgroundColor3 = Color3.fromRGB(40, 25, 70)
ComingSoonLabel.BorderSizePixel = 0
ComingSoonLabel.Size = UDim2.new(1, 0, 0, 100)
ComingSoonLabel.Font = Enum.Font.GothamBold
ComingSoonLabel.Text = "COMING SOON"
ComingSoonLabel.TextColor3 = Color3.fromRGB(220, 180, 255)
ComingSoonLabel.TextSize = 32

local ComingSoonCorner = Instance.new("UICorner")
ComingSoonCorner.CornerRadius = UDim.new(0, 10)
ComingSoonCorner.Parent = ComingSoonLabel

local ComingSoonStroke = Instance.new("UIStroke")
ComingSoonStroke.Color = Color3.fromRGB(100, 60, 150)
ComingSoonStroke.Thickness = 2
ComingSoonStroke.Transparency = 0.6
ComingSoonStroke.Parent = ComingSoonLabel

-- ============================================
-- MISC TAB
-- ============================================

local MiscTitle = Instance.new("TextLabel")
MiscTitle.Parent = Tab3Scroll
MiscTitle.BackgroundTransparency = 1
MiscTitle.Size = UDim2.new(1, 0, 0, 30)
MiscTitle.Font = Enum.Font.GothamBold
MiscTitle.Text = "Miscellaneous Settings"
MiscTitle.TextColor3 = Color3.fromRGB(220, 180, 255)
MiscTitle.TextSize = 20
MiscTitle.TextXAlignment = Enum.TextXAlignment.Left

-- Visual Settings Frame (Full Bright + Remove Fog)
local VisualFrame = createFrame(Tab3Scroll, 140)

local VisualTitle = Instance.new("TextLabel")
VisualTitle.Parent = VisualFrame
VisualTitle.BackgroundTransparency = 1
VisualTitle.Position = UDim2.new(0, 15, 0, 10)
VisualTitle.Size = UDim2.new(1, -30, 0, 25)
VisualTitle.Font = Enum.Font.GothamBold
VisualTitle.Text = "Visual Settings"
VisualTitle.TextColor3 = Color3.fromRGB(220, 180, 255)
VisualTitle.TextSize = 18
VisualTitle.TextXAlignment = Enum.TextXAlignment.Left

local FullBrightToggle = createToggle("Full Bright", 40, VisualFrame, false)
local RemoveFogToggle = createToggle("Remove Fog", 75, VisualFrame, false)

-- ============================================
-- FULL BRIGHT LOGIC (IMPROVED - MUCH BRIGHTER)
-- ============================================

local fullBrightConnection = nil

local function enableFullBright()
    pcall(function()
        -- Save original settings
        originalLightingSettings = {
            Brightness = Lighting.Brightness,
            Ambient = Lighting.Ambient,
            OutdoorAmbient = Lighting.OutdoorAmbient,
            ColorShift_Bottom = Lighting.ColorShift_Bottom,
            ColorShift_Top = Lighting.ColorShift_Top,
            EnvironmentDiffuseScale = Lighting.EnvironmentDiffuseScale,
            EnvironmentSpecularScale = Lighting.EnvironmentSpecularScale,
            GlobalShadows = Lighting.GlobalShadows,
            ShadowSoftness = Lighting.ShadowSoftness
        }
        
        -- Set to maximum brightness (MUCH BRIGHTER THAN BEFORE)
        Lighting.Brightness = 5  -- Increased from 3
        Lighting.Ambient = Color3.fromRGB(255, 255, 255)  -- Pure white
        Lighting.OutdoorAmbient = Color3.fromRGB(255, 255, 255)  -- Pure white
        Lighting.ColorShift_Bottom = Color3.fromRGB(255, 255, 255)
        Lighting.ColorShift_Top = Color3.fromRGB(255, 255, 255)
        Lighting.EnvironmentDiffuseScale = 1
        Lighting.EnvironmentSpecularScale = 1
        Lighting.GlobalShadows = false
        Lighting.ShadowSoftness = 0
        
        -- Monitor and maintain settings
        fullBrightConnection = Lighting.Changed:Connect(function(property)
            if FullBrightEnabled then
                if property == "Brightness" and Lighting.Brightness ~= 5 then
                    Lighting.Brightness = 5
                elseif property == "Ambient" then
                    Lighting.Ambient = Color3.fromRGB(255, 255, 255)
                elseif property == "OutdoorAmbient" then
                    Lighting.OutdoorAmbient = Color3.fromRGB(255, 255, 255)
                elseif property == "GlobalShadows" and Lighting.GlobalShadows ~= false then
                    Lighting.GlobalShadows = false
                end
            end
        end)
    end)
end

local function disableFullBright()
    pcall(function()
        if fullBrightConnection then
            fullBrightConnection:Disconnect()
            fullBrightConnection = nil
        end
        
        -- Restore all original settings
        if originalLightingSettings.Brightness then
            Lighting.Brightness = originalLightingSettings.Brightness
            Lighting.Ambient = originalLightingSettings.Ambient
            Lighting.OutdoorAmbient = originalLightingSettings.OutdoorAmbient
            Lighting.ColorShift_Bottom = originalLightingSettings.ColorShift_Bottom
            Lighting.ColorShift_Top = originalLightingSettings.ColorShift_Top
            Lighting.EnvironmentDiffuseScale = originalLightingSettings.EnvironmentDiffuseScale
            Lighting.EnvironmentSpecularScale = originalLightingSettings.EnvironmentSpecularScale
            Lighting.GlobalShadows = originalLightingSettings.GlobalShadows
            Lighting.ShadowSoftness = originalLightingSettings.ShadowSoftness
            
            originalLightingSettings = {}
        end
    end)
end

FullBrightToggle.ToggleButton.MouseButton1Click:Connect(function()
    FullBrightEnabled = not FullBrightEnabled
    
    if FullBrightEnabled then
        FullBrightToggle.ToggleCircle:TweenPosition(UDim2.new(1, -22, 0.5, -10), "Out", "Quad", 0.2, true)
        FullBrightToggle.ToggleBg.BackgroundColor3 = Color3.fromRGB(100, 60, 180)
        FullBrightToggle.ToggleCircle.BackgroundColor3 = Color3.fromRGB(200, 160, 240)
        enableFullBright()
    else
        FullBrightToggle.ToggleCircle:TweenPosition(UDim2.new(0, 2, 0.5, -10), "Out", "Quad", 0.2, true)
        FullBrightToggle.ToggleBg.BackgroundColor3 = Color3.fromRGB(60, 40, 90)
        FullBrightToggle.ToggleCircle.BackgroundColor3 = Color3.fromRGB(150, 100, 200)
        disableFullBright()
    end
end)

-- ============================================
-- REMOVE FOG LOGIC (NEW FEATURE)
-- ============================================

local removeFogConnection = nil

local function enableRemoveFog()
    pcall(function()
        -- Save original fog settings
        originalFogSettings = {
            FogEnd = Lighting.FogEnd,
            FogStart = Lighting.FogStart,
            FogColor = Lighting.FogColor
        }
        
        -- Remove all fog
        Lighting.FogEnd = 100000
        Lighting.FogStart = 100000
        
        -- Remove atmospheric effects if they exist
        for _, effect in pairs(Lighting:GetChildren()) do
            if effect:IsA("Atmosphere") then
                if not originalFogSettings.Atmosphere then
                    originalFogSettings.Atmosphere = {
                        Density = effect.Density,
                        Offset = effect.Offset,
                        Color = effect.Color,
                        Decay = effect.Decay,
                        Glare = effect.Glare,
                        Haze = effect.Haze
                    }
                end
                effect.Density = 0
                effect.Offset = 0
                effect.Glare = 0
                effect.Haze = 0
            end
        end
        
        -- Monitor and maintain no fog
        removeFogConnection = Lighting.Changed:Connect(function(property)
            if RemoveFogEnabled then
                if property == "FogEnd" and Lighting.FogEnd ~= 100000 then
                    Lighting.FogEnd = 100000
                elseif property == "FogStart" and Lighting.FogStart ~= 100000 then
                    Lighting.FogStart = 100000
                end
            end
        end)
    end)
end

local function disableRemoveFog()
    pcall(function()
        if removeFogConnection then
            removeFogConnection:Disconnect()
            removeFogConnection = nil
        end
        
        -- Restore original fog settings
        if originalFogSettings.FogEnd then
            Lighting.FogEnd = originalFogSettings.FogEnd
            Lighting.FogStart = originalFogSettings.FogStart
            Lighting.FogColor = originalFogSettings.FogColor
            
            -- Restore atmospheric effects
            if originalFogSettings.Atmosphere then
                for _, effect in pairs(Lighting:GetChildren()) do
                    if effect:IsA("Atmosphere") then
                        effect.Density = originalFogSettings.Atmosphere.Density
                        effect.Offset = originalFogSettings.Atmosphere.Offset
                        effect.Color = originalFogSettings.Atmosphere.Color
                        effect.Decay = originalFogSettings.Atmosphere.Decay
                        effect.Glare = originalFogSettings.Atmosphere.Glare
                        effect.Haze = originalFogSettings.Atmosphere.Haze
                    end
                end
            end
            
            originalFogSettings = {}
        end
    end)
end

RemoveFogToggle.ToggleButton.MouseButton1Click:Connect(function()
    RemoveFogEnabled = not RemoveFogEnabled
    
    if RemoveFogEnabled then
        RemoveFogToggle.ToggleCircle:TweenPosition(UDim2.new(1, -22, 0.5, -10), "Out", "Quad", 0.2, true)
        RemoveFogToggle.ToggleBg.BackgroundColor3 = Color3.fromRGB(100, 60, 180)
        RemoveFogToggle.ToggleCircle.BackgroundColor3 = Color3.fromRGB(200, 160, 240)
        enableRemoveFog()
    else
        RemoveFogToggle.ToggleCircle:TweenPosition(UDim2.new(0, 2, 0.5, -10), "Out", "Quad", 0.2, true)
        RemoveFogToggle.ToggleBg.BackgroundColor3 = Color3.fromRGB(60, 40, 90)
        RemoveFogToggle.ToggleCircle.BackgroundColor3 = Color3.fromRGB(150, 100, 200)
        disableRemoveFog()
    end
end)

-- FreeCam Frame
local FreeCamFrame = createFrame(Tab3Scroll, 110)

local FreeCamTitle = Instance.new("TextLabel")
FreeCamTitle.Parent = FreeCamFrame
FreeCamTitle.BackgroundTransparency = 1
FreeCamTitle.Position = UDim2.new(0, 15, 0, 10)
FreeCamTitle.Size = UDim2.new(1, -30, 0, 25)
FreeCamTitle.Font = Enum.Font.GothamBold
FreeCamTitle.Text = "FreeCam"
FreeCamTitle.TextColor3 = Color3.fromRGB(220, 180, 255)
FreeCamTitle.TextSize = 18
FreeCamTitle.TextXAlignment = Enum.TextXAlignment.Left

local FreeCamToggle = createToggle("Enable FreeCam", 40, FreeCamFrame, false)

-- FreeCam Keybind
local FreeCamKeybindLabel = Instance.new("TextLabel")
FreeCamKeybindLabel.Parent = FreeCamFrame
FreeCamKeybindLabel.BackgroundTransparency = 1
FreeCamKeybindLabel.Position = UDim2.new(0, 15, 0, 75)
FreeCamKeybindLabel.Size = UDim2.new(0.4, 0, 0, 25)
FreeCamKeybindLabel.Font = Enum.Font.Gotham
FreeCamKeybindLabel.Text = "Toggle Key:"
FreeCamKeybindLabel.TextColor3 = Color3.fromRGB(200, 160, 240)
FreeCamKeybindLabel.TextSize = 14
FreeCamKeybindLabel.TextXAlignment = Enum.TextXAlignment.Left

local FreeCamKeybindButton = Instance.new("TextButton")
FreeCamKeybindButton.Parent = FreeCamFrame
FreeCamKeybindButton.BackgroundColor3 = Color3.fromRGB(60, 40, 100)
FreeCamKeybindButton.BorderSizePixel = 0
FreeCamKeybindButton.Position = UDim2.new(0.45, 0, 0, 75)
FreeCamKeybindButton.Size = UDim2.new(0, 120, 0, 25)
FreeCamKeybindButton.Font = Enum.Font.GothamBold
FreeCamKeybindButton.Text = "C"
FreeCamKeybindButton.TextColor3 = Color3.fromRGB(220, 180, 255)
FreeCamKeybindButton.TextSize = 14

local FreeCamKeybindCorner = Instance.new("UICorner")
FreeCamKeybindCorner.CornerRadius = UDim.new(0, 6)
FreeCamKeybindCorner.Parent = FreeCamKeybindButton

local FreeCamKeybindStroke = Instance.new("UIStroke")
FreeCamKeybindStroke.Color = Color3.fromRGB(120, 80, 180)
FreeCamKeybindStroke.Thickness = 1.5
FreeCamKeybindStroke.Parent = FreeCamKeybindButton

local FreeCamKeybind = Enum.KeyCode.C
local SettingFreeCamKeybind = false

-- ============================================
-- FIXED FREECAM KEYBIND BUTTON LISTENER
-- ============================================
FreeCamKeybindButton.MouseButton1Click:Connect(function()
    if not SettingFreeCamKeybind then
        SettingFreeCamKeybind = true
        FreeCamKeybindButton.Text = "Press any key..."
        FreeCamKeybindButton.BackgroundColor3 = Color3.fromRGB(80, 50, 130)
    end
end)

-- FREECAM LOGIC (FIXED - MOUSE LOOK NOW WORKS)

local Camera = workspace.CurrentCamera
local freeCamConnection = nil
local originalCameraSubject = nil
local FreeCamRotation = Vector2.new(0, 0)

local function enableFreeCam()
    FreeCamCFrame = Camera.CFrame
    FreeCamRotation = Vector2.new(0, 0)
    originalCameraSubject = Camera.CameraSubject
    
    Camera.CameraType = Enum.CameraType.Scriptable
    UserInputService.MouseBehavior = Enum.MouseBehavior.LockCenter
    
    freeCamConnection = RunService.RenderStepped:Connect(function(dt)
        if not FreeCamEnabled then return end
        
        local moveVector = Vector3.new(0, 0, 0)
        local speed = FreeCamSpeed * 50 * dt
        
        if UserInputService:IsKeyDown(Enum.KeyCode.W) then
            moveVector = moveVector + (FreeCamCFrame.LookVector * speed)
        end
        if UserInputService:IsKeyDown(Enum.KeyCode.S) then
            moveVector = moveVector - (FreeCamCFrame.LookVector * speed)
        end
        if UserInputService:IsKeyDown(Enum.KeyCode.A) then
            moveVector = moveVector - (FreeCamCFrame.RightVector * speed)
        end
        if UserInputService:IsKeyDown(Enum.KeyCode.D) then
            moveVector = moveVector + (FreeCamCFrame.RightVector * speed)
        end
        if UserInputService:IsKeyDown(Enum.KeyCode.E) or UserInputService:IsKeyDown(Enum.KeyCode.Space) then
            moveVector = moveVector + (Vector3.new(0, 1, 0) * speed)
        end
        if UserInputService:IsKeyDown(Enum.KeyCode.Q) then
            moveVector = moveVector - (Vector3.new(0, 1, 0) * speed)
        end
        
        FreeCamCFrame = FreeCamCFrame + moveVector
        Camera.CFrame = FreeCamCFrame
    end)
end

local mouseConnection = UserInputService.InputChanged:Connect(function(input)
    if not FreeCamEnabled then return end
    
    if input.UserInputType == Enum.UserInputType.MouseMovement then
        local delta = input.Delta
        local sensitivity = 0.003
        
        FreeCamRotation = FreeCamRotation + Vector2.new(-delta.X * sensitivity, -delta.Y * sensitivity)
        FreeCamRotation = Vector2.new(
            FreeCamRotation.X,
            math.clamp(FreeCamRotation.Y, -math.pi/2 + 0.1, math.pi/2 - 0.1)
        )
        
        local cameraCFrame = CFrame.new(FreeCamCFrame.Position)
            * CFrame.Angles(0, FreeCamRotation.X, 0)
            * CFrame.Angles(FreeCamRotation.Y, 0, 0)
        
        FreeCamCFrame = cameraCFrame
    end
end)

local function disableFreeCam()
    if freeCamConnection then
        freeCamConnection:Disconnect()
        freeCamConnection = nil
    end
    
    UserInputService.MouseBehavior = Enum.MouseBehavior.Default
    Camera.CameraType = Enum.CameraType.Custom
    Camera.CameraSubject = originalCameraSubject or (LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid"))
end

FreeCamToggle.ToggleButton.MouseButton1Click:Connect(function()
    FreeCamEnabled = not FreeCamEnabled
    
    if FreeCamEnabled then
        FreeCamToggle.ToggleCircle:TweenPosition(UDim2.new(1, -22, 0.5, -10), "Out", "Quad", 0.2, true)
        FreeCamToggle.ToggleBg.BackgroundColor3 = Color3.fromRGB(100, 60, 180)
        FreeCamToggle.ToggleCircle.BackgroundColor3 = Color3.fromRGB(200, 160, 240)
        enableFreeCam()
    else
        FreeCamToggle.ToggleCircle:TweenPosition(UDim2.new(0, 2, 0.5, -10), "Out", "Quad", 0.2, true)
        FreeCamToggle.ToggleBg.BackgroundColor3 = Color3.fromRGB(60, 40, 90)
        FreeCamToggle.ToggleCircle.BackgroundColor3 = Color3.fromRGB(150, 100, 200)
        disableFreeCam()
    end
end)

-- Keybind Section
local SettingsTitle = Instance.new("TextLabel")
SettingsTitle.Parent = Tab3Scroll
SettingsTitle.BackgroundTransparency = 1
SettingsTitle.Size = UDim2.new(1, 0, 0, 30)
SettingsTitle.Font = Enum.Font.GothamBold
SettingsTitle.Text = "Open/Close UI"
SettingsTitle.TextColor3 = Color3.fromRGB(220, 180, 255)
SettingsTitle.TextSize = 20
SettingsTitle.TextXAlignment = Enum.TextXAlignment.Left

local KeybindFrame = createFrame(Tab3Scroll, 60)

local KeybindLabel = Instance.new("TextLabel")
KeybindLabel.Parent = KeybindFrame
KeybindLabel.BackgroundTransparency = 1
KeybindLabel.Position = UDim2.new(0, 15, 0, 0)
KeybindLabel.Size = UDim2.new(0.5, -15, 1, 0)
KeybindLabel.Font = Enum.Font.Gotham
KeybindLabel.Text = "Current Key:"
KeybindLabel.TextColor3 = Color3.fromRGB(200, 160, 240)
KeybindLabel.TextSize = 16
KeybindLabel.TextXAlignment = Enum.TextXAlignment.Left

local KeybindButton = Instance.new("TextButton")
KeybindButton.Parent = KeybindFrame
KeybindButton.BackgroundColor3 = Color3.fromRGB(60, 40, 100)
KeybindButton.BorderSizePixel = 0
KeybindButton.Position = UDim2.new(0.5, 5, 0.5, -15)
KeybindButton.Size = UDim2.new(0, 180, 0, 30)
KeybindButton.Font = Enum.Font.GothamBold
KeybindButton.Text = "RightShift"
KeybindButton.TextColor3 = Color3.fromRGB(220, 180, 255)
KeybindButton.TextSize = 15

local KeybindButtonCorner = Instance.new("UICorner")
KeybindButtonCorner.CornerRadius = UDim.new(0, 6)
KeybindButtonCorner.Parent = KeybindButton

local KeybindButtonStroke = Instance.new("UIStroke")
KeybindButtonStroke.Color = Color3.fromRGB(120, 80, 180)
KeybindButtonStroke.Thickness = 1.5
KeybindButtonStroke.Parent = KeybindButton

local CreditLabel = Instance.new("TextLabel")
CreditLabel.Parent = Tab3Scroll
CreditLabel.BackgroundColor3 = Color3.fromRGB(40, 25, 70)
CreditLabel.BorderSizePixel = 0
CreditLabel.Size = UDim2.new(1, 0, 0, 50)
CreditLabel.Font = Enum.Font.GothamBold
CreditLabel.Text = "Made by: MidnightSoul"
CreditLabel.TextColor3 = Color3.fromRGB(220, 180, 255)
CreditLabel.TextSize = 18

local CreditCorner = Instance.new("UICorner")
CreditCorner.CornerRadius = UDim.new(0, 10)
CreditCorner.Parent = CreditLabel

local CreditStroke = Instance.new("UIStroke")
CreditStroke.Color = Color3.fromRGB(100, 60, 150)
CreditStroke.Thickness = 2
CreditStroke.Transparency = 0.6
CreditStroke.Parent = CreditLabel

KeybindButton.MouseButton1Click:Connect(function()
    if not SettingKeybind then
        SettingKeybind = true
        KeybindButton.Text = "Press any key..."
        KeybindButton.BackgroundColor3 = Color3.fromRGB(80, 50, 130)
    end
end)

UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if SettingKeybind then
        ToggleKeybind = input.KeyCode
        KeybindButton.Text = input.KeyCode.Name
        KeybindButton.BackgroundColor3 = Color3.fromRGB(60, 40, 100)
        SettingKeybind = false
    elseif SettingFreeCamKeybind then
        FreeCamKeybind = input.KeyCode
        FreeCamKeybindButton.Text = input.KeyCode.Name
        FreeCamKeybindButton.BackgroundColor3 = Color3.fromRGB(60, 40, 100)
        SettingFreeCamKeybind = false
    elseif input.KeyCode == ToggleKeybind and not gameProcessed then
        MainFrame.Visible = not MainFrame.Visible
    elseif input.KeyCode == FreeCamKeybind and not gameProcessed then
        FreeCamEnabled = not FreeCamEnabled
        
        if FreeCamEnabled then
            FreeCamToggle.ToggleCircle:TweenPosition(UDim2.new(1, -22, 0.5, -10), "Out", "Quad", 0.2, true)
            FreeCamToggle.ToggleBg.BackgroundColor3 = Color3.fromRGB(100, 60, 180)
            FreeCamToggle.ToggleCircle.BackgroundColor3 = Color3.fromRGB(200, 160, 240)
            enableFreeCam()
        else
            FreeCamToggle.ToggleCircle:TweenPosition(UDim2.new(0, 2, 0.5, -10), "Out", "Quad", 0.2, true)
            FreeCamToggle.ToggleBg.BackgroundColor3 = Color3.fromRGB(60, 40, 90)
            FreeCamToggle.ToggleCircle.BackgroundColor3 = Color3.fromRGB(150, 100, 200)
            disableFreeCam()
        end
    end
end)

local function switchTab(tabContent, button)
    Tab1Content.Visible = false
    Tab2Content.Visible = false
    Tab3Content.Visible = false
    
    Tab1Button.BackgroundColor3 = Color3.fromRGB(30, 20, 50)
    Tab2Button.BackgroundColor3 = Color3.fromRGB(30, 20, 50)
    Tab3Button.BackgroundColor3 = Color3.fromRGB(30, 20, 50)
    
    tabContent.Visible = true
    button.BackgroundColor3 = Color3.fromRGB(70, 45, 120)
end

Tab1Button.MouseButton1Click:Connect(function()
    switchTab(Tab1Content, Tab1Button)
end)

Tab2Button.MouseButton1Click:Connect(function()
    switchTab(Tab2Content, Tab2Button)
end)

Tab3Button.MouseButton1Click:Connect(function()
    switchTab(Tab3Content, Tab3Button)
end)

-- Loading animation
task.spawn(function()
    for i = 1, #"Midnight Hub" do
        LoadingText.Text = string.sub("Midnight Hub", 1, i)
        task.wait(0.25)
    end
    
    task.wait(0.5)
    
    for i = 0, 10 do
        LoadingText.TextTransparency = i / 10
        LoadingStroke.Transparency = i / 10
        task.wait(0.03)
    end
    
    LoadingText:Destroy()
    
    MainFrame.Visible = true
    switchTab(Tab1Content, Tab1Button)
    print("GUI fully loaded!")
end)

-- Gradient animation
task.spawn(function()
    while task.wait(0.05) do
        if Gradient and Gradient.Parent then
            Gradient.Rotation = Gradient.Rotation + 0.5
        end
    end
end)

print("Midnight GUI Script Loaded Successfully!")
print("Default keybind: RightShift (Change in Settings)")
